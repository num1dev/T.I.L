# 2023.03.24

태그: SQL

## SQL

<br>

### 1. L**ike의 기능과 의미**

- "LIKE" 연산자는 특정 문자열 패턴을 검색하는 데 사용.
- 비교하는 두 문자열 중 하나의 문자열이 다른 문자열의 일부분과 일치하는 경우, 두 문자열을 일치하는 것으로 간주
- 두 가지 와일드카드 문자를 사용.
    - "%" : 0개 이상의 문자를 대체하는 와일드카드
    - "_" : 한 개의 문자를 대체하는 와일드카드
- 대소문자를 구분
    - "LIKE 'apple%'"와 "LIKE 'Apple%'"가 서로 다른 결과를 반환한다는 것을 의미
    - 대소문자를 무시하려면 "LOWER"나 "UPPER" 함수를 사용하여 문자열을 모두 소문자나 대문자로 변환한 다음 "LIKE" 연산자를 사용

<br>

### 2. Like **__ 의 기능과 의미**

- 와일드카드 문자
- 하나의 언더스코어 "_"는 하나의 문자를 대체하는데 사용
- 두 개의 언더스코어 **"**"는 두 개의 문자를 대체하는데 사용
- "__" 와일드카드는 특정 개수의 문자를 대체하는데 사용되며, 이를 이용하여 보다 정확한 문자열 검색이 가능

<br>

### 3.문자를 대체하는 와일드카드

- "%"
    - 문자열에서 0개 이상의 문자를 대체,
        - "a%"는 "a"로 시작하는 모든 문자열을 검색
        - "a%", "%a%", "%a", "a%%a"와 같은 모든 문자열이 해당.
    - 경우의 수는 무한.
- "_"
    - 문자열에서 한 개의 문자를 대체.
        - "a_c"는 "a"로 시작하고 "c"로 끝나며, 그 사이에 단 하나의 문자가 있는 모든 문자열을 검색.
        - "abc", "adc", "aec"와 같은 모든 3자리 문자열이 해당
    - 경우의 수는 문자열의 길이에 따라 달라짐



### 4. **sort의 의미와 기능**

- SQL에서 "SORT"는 검색된 데이터를 원하는 방식으로 정렬하는데 사용되는 기능.
- 데이터베이스 테이블에서 데이터를 검색하면 일반적으로 데이터가 무작위 순서로 반환됨.
- 이러한 상태에서 데이터를 가치 있는 정보로 전환하기 위해 정렬이 필요.
    - 정렬은 데이터의 순서를 변경하여 원하는 순서로 재배치하는 것
    - 데이터를 쉽게 찾을 수 있도록 하고, 패턴을 파악할 수 있게 함.
- SQL에서는 "ORDER BY" 절을 사용하여 데이터를 정렬
- "ORDER BY" 절은 정렬하고자 하는 열의 이름을 지정하고, 오름차순 또는 내림차순으로 정렬할지 여부를 선택

<br>

### 5. **자바의 콜렉션과 vs SQL의 sort (정렬)**

- 자바의 콜렉션
    - 일반적으로 메모리 내부에 데이터를 저장하고 정렬하는데 사용
    - 콜렉션의 종류에 따라 다양한 정렬 알고리즘을 사용할 수 있으며, 빠른 속도로 데이터를 정렬.
    - 하지만, 콜렉션은 메모리 제한에 따라 정렬할 수 있는 데이터의 양이 제한
- SQL의 정렬
    - 일반적으로 디스크에 저장된 데이터를 정렬하는데 사용
    - 따라서 대용량의 데이터를 정렬가능
    - SQL은 데이터베이스 엔진에서 최적화된 정렬 알고리즘을 사용하여 빠른 속도로 데이터를 정렬
    - 쿼리의 결과를 바로 반환할 수 있으므로, 콜렉션과 달리 메모리 제한에 영향을 받지 않음
- 대량의 데이터를 정렬해야하는 경우
    - SQL의 정렬 사용
- 상대적으로 작은 양의 데이터를 정렬해야 하는 경우
    - 자바의 콜렉션을 사용

<br>

### 6. **Full Outer Join**

- 이너 조인과 왼쪽 아우터 조인, 오른쪽 아우터 조인의 조합
- 두 개의 테이블에서 조인할 때 왼쪽 테이블과 오른쪽 테이블의 모든 레코드를 포함하면서 공통된 값을 기준으로 조인.
    - 왼쪽 테이블과 오른쪽 테이블 모두에 존재하는 레코드는 일치하는 값으로 조인
    - 왼쪽 테이블에만 존재하는 레코드는 NULL 값으로 오른쪽 테이블과 조인
    - 오른쪽 테이블에만 존재하는 레코드는 NULL 값으로 왼쪽 테이블과 조인.
- "FULL OUTER JOIN" 키워드를 사용하여 구현

<br>

```sql

SELECT *
FROM 테이블1
FULL OUTER JOIN 테이블2
ON 테이블1.열 = 테이블2.열;

```

<br>

### 7. **join 과 subquery**

- JOIN
    - 두 개 이상의 테이블에서 공통된 값을 기준으로 데이터를 조합하는 방법
    - 조인 대상이 되는 테이블이 많을수록 성능이 저하
    - 대용량의 데이터를 다룰 때는 JOIN 대신 Subquery를 사용
- Subquery
    - SELECT 문 내부에 작성되는 하위 쿼리
    - 조건에 해당하는 데이터를 먼저 검색한 후, 그 결과를 이용하여 다시 검색하는 방법
    - 쿼리문이 복잡할 때 가독성을 높일 수 있으며, 조인 대상이 되는 테이블이 많을 때 성능 개선을 기대할 수 있음.
- Subquery와 JOIN 사용 기준.
    - 데이터베이스의 용량과 성능
    - 작성하는 쿼리문의 복잡도
    - 조건에 따라 결과 값이 나오는 시간
    - 작성하는 쿼리문의 유지보수성
- 결론
    - JOIN은 조인 대상이 되는 테이블이 적고 단순한 쿼리문에서 사용
    - Subquery는 복잡한 쿼리문이나 대용량의 데이터를 다룰 때 사용


<br>

### 8. **my sql의 now 함수**

- 현재 날짜와 시간을 반환하는 함수입니다.
- 현재 시스템 시간을 기준으로 값을 반환.
- TIMESTAMP 형식으로 값을 반환
- YYYY-MM-DD HH:MM:SS 형식의 문자열로도 반환할 수 있음.

<br>

```sql

SELECT NOW(); -- 현재 날짜와 시간을 TIMESTAMP 형식으로 반환

SELECT DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'); -- YYYY-MM-DD HH:MM:SS 형식으로 반환

위의 예제에서는 NOW() 함수를 사용하여 현재 날짜와 시간을 반환하고, DATE_FORMAT 함수를 사용하여 이 값을 YYYY-MM-DD HH:MM:SS 형식으로 변환하고 있습니다.
```

<br>

- now() 함수
    - 현재 날짜와 시간을 반환
    - 반환되는 값은 'YYYY-MM-DD HH:MM:SS' 또는 YYYYMMDDHHMMSS 형태로 반환
- CURDATE() 함수
    - 현재 날짜를 반환.
    - 반환되는 값은 'YYYY-MM-DD' 또는 YYYYMMDD 형태로 반환
- CURTIME() 함수
    - 현재 시각을 반환.
    - 반환되는 값은 'HH:MM:SS' 또는 HHMMSS 형태로 반환.

<br>

### 9. **executeupdate**

- SQL 문을 실행하고, 영향을 받은 행의 수(즉, 변경된 행 수)를 반환하는 메서드.
- INSERT, UPDATE, DELETE와 같은 DML(Data Manipulation Language) 쿼리문을 실행하는 데 사용
- Connection 객체의 메서드로, Connection 객체를 사용하여 데이터베이스와 연결된 후에 사용할 수 있음.
- SQL문을 실행한 후, 변경된 행의 수를 int 형태로 반환.

<br>

### 10. **executeUpdate와 executeQUery의 리턴값**

- executeUpdate()와 executeQuery() 메서드는 각각 SQL 문을 실행하고, 결과값을 반환하는 메서드.
- 메서드의 반환값은 실행한 SQL 문에 따라 다름.
- executeUpdate() 메서드는
    - INSERT, UPDATE, DELETE와 같은 DML(Data Manipulation Language) 쿼리문을 실행하는 데 사용.
    - 실행한 SQL 문에 의해 변경된 행의 수를 반환.
    - 반환값은 int 형태로, SQL 문이 영향을 미친 행의 수를 표현
- executeQuery() 메서드는
    - SELECT 쿼리문을 실행하는 데 사용
    - 실행한 SQL 문에 따라 ResultSet 객체를 반환.
    - ResultSet 객체는 SELECT 문으로 조회한 데이터를 담음
- executeUpdate()와 executeQuery() 메서드의 차이점.

|  | executeUpdate() | executeQuery() |
| --- | --- | --- |
| 사용 예 | INSERT, UPDATE, DELETE 쿼리문 | SELECT 쿼리문 |
| 반환 값 | 실행한 SQL 문에 영향을 미친 행 수(int) | 조회한 결과를 담은 ResultSet 객체 |
| 반환 형식 | int | ResultSet |
| 사용 방법 | Statement, PreparedStatement, CallableStatement | Statement, PreparedStatement, CallableStatement |
| SQL 인젝션 공격 | 미방지 가능 | PreparedStatement 사용 시 방지 가능 |
| 데이터 유형 | DML 쿼리문 | SELECT 쿼리문 |

<br>

### 11.DDL

- 데이터베이스의 구조를 정의하는 언어
- 데이터베이스 객체를 생성, 수정, 삭제하는 등의 작업을 수행
- SQL에서 CREATE, ALTER, DROP 등의 문장을 사용하여 데이터베이스를 정의.
- DDL 문장은 데이터베이스의 구조를 변경하는 데 사용되므로 잘못된 DDL 문장은 데이터베이스를 손상시키거나, 데이터를 삭제하는 등의 치명적인 문제를 야기
- 주요 DDL 문장
    - CREATE: 테이블, 뷰, 인덱스 등의 데이터베이스 객체를 생성
    - ALTER: 테이블, 뷰, 인덱스 등의 데이터베이스 객체를 변경.
    - DROP: 테이블, 뷰, 인덱스 등의 데이터베이스 객체를 삭제.
    - TRUNCATE: 테이블을 초기화하여 모든 데이터를 삭제.
    - COMMENT: 주석을 추가하거나 수정
